<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Object Manager</title>
  <style>
    table, th, td { border: 1px solid black; border-collapse: collapse; padding: 6px; }
  </style>
</head>
<body>
  <h1>Object Manager</h1>

  <h2>Add Object</h2>
  <input type="text" id="name" placeholder="Name">
  <input type="number" id="price" placeholder="Price">
  <input type="number" id="quantity" placeholder="Quantity" value="1">
  <button onclick="addObject()">Add</button>

  <h2>Objects</h2>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Total</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody id="objectTable"></tbody>
  </table>

  <script>
    const API_URL = "https://object-manager.onrender.com/api/objects";

    // Load objects
    async function loadObjects() {
      const res = await fetch(API_URL);
      const objects = await res.json();

      const table = document.getElementById("objectTable");
      table.innerHTML = "";

      objects.forEach(obj => {
        const row = document.createElement("tr");
        const total = (obj.price || 0) * (obj.quantity || 0);

        row.innerHTML = `
          <td>${obj.name}</td>
          <td>${obj.price}</td>
          <td>${obj.quantity}</td>
          <td>${total}</td>
          <td><button onclick="editObject('${obj._id}')">Edit</button></td>
          <td><button onclick="deleteObject('${obj._id}')">Delete</button></td>
        `;
        table.appendChild(row);
      });
    }

    // Add new object
    async function addObject() {
      const name = document.getElementById("name").value;
      const price = Number(document.getElementById("price").value);
      const quantity = Number(document.getElementById("quantity").value);

      if (!name || isNaN(price) || isNaN(quantity)) {
        alert("Please fill all fields correctly");
        return;
      }

      await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, price, quantity })
      });

      document.getElementById("name").value = "";
      document.getElementById("price").value = "";
      document.getElementById("quantity").value = 1;

      loadObjects();
    }

    // Delete object
    async function deleteObject(id) {
      await fetch(`${API_URL}/${id}`, { method: "DELETE" });
      loadObjects();
    }

    // Edit object
    async function editObject(id) {
      const newName = prompt("Enter new name:");
      const newPrice = Number(prompt("Enter new price:"));
      const newQuantity = Number(prompt("Enter new quantity:"));

      if (!newName || isNaN(newPrice) || isNaN(newQuantity)) {
        alert("Invalid input!");
        return;
      }

      await fetch(`${API_URL}/${id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name: newName, price: newPrice, quantity: newQuantity })
      });

      loadObjects();
    }

    loadObjects();
  </script>
</body>
</html>
